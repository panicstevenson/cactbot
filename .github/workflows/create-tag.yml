name: Create Tag

on:
  push:
    branches:
      - 'master'
    paths:
      - 'plugin/CactbotOverlay/Properties/AssemblyInfo.cs'

jobs:
  create-tag:
    runs-on: ubuntu-latest
    if: ${{ github.repository == 'panicstevenson/cactbot' }}
    steps:
      - name: Checkout Code
        uses: actions/checkout@v2
      - name: Create Tag
        run: |
          VERSION="v$(cat plugin/CactbotOverlay/Properties/AssemblyInfo.cs | sed -ne 's/.*AssemblyFileVersion.*"\([0-9]*\.[0-9]*\.[0-9]*\)\.0".*/\1/p')"
          git tag -a $VERSION
          git push $VERSION
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }}
