(()=>{"use strict";const t=["timestamp","source","id","ability","target","capture"],e=["timestamp","source","sourceId","id","ability","targetId","target","capture"],a=["timestamp","sourceId","source","id","ability","targetId","target","flags","flag0","flag1","flag2","flag3","flag4","flag5","flag6","flag7","flag8","flag9","flag10","flag11","flag12","flag13","flag14","targetHp","targetMaxHp","targetMp","targetMaxMp","targetX","targetY","targetZ","targetHeading","hp","maxHp","mp","maxMp","x","y","z","heading","capture"],i=["timestamp","targetId","target","id","capture"],s=["timestamp","name","capture"],n=["timestamp","id","name","job","level","hp","x","y","z","npcId","capture"],r=["timestamp","id","name","hp","x","y","z","capture"],l=["timestamp","targetId","target","effect","source","duration","capture"],o=["timestamp","targetId","target","job","hp","maxHp","mp","maxMp","x","y","z","heading","data0","data1","data2","data3","data4","capture"],d=["timestamp","targetId","target","effect","source","capture"],u=["timestamp","job","strength","dexterity","vitality","intelligence","mind","piety","attackPower","directHit","criticalHit","attackMagicPotency","healMagicPotency","determination","skillSpeed","spellSpeed","tenacity","capture"],p=["timestamp","source","sourceId","target","targetId","id","capture"],m=["timestamp","target","source","capture"],c=["timestamp","name","hp","capture"],h=["timestamp","code","line","capture"],g=["timestamp","code","line","name","capture"],f=["timestamp","code","line","capture"],y=["timestamp","code","line","capture"],v=["timestamp","code","name","line","capture"],b=["timestamp","name","capture"],C=["timestamp","instance","command","data0","data1","data2","data3","capture"];class x{static startsUsing(e){void 0===e&&(e={}),x.validateParams(e,"startsUsing",t);const a=x.trueIfUndefined(e.capture);let i=x.maybeCapture(a,"timestamp","\\y{Timestamp}")+" 14:"+x.maybeCapture(a,"id",e.id,"\\y{AbilityCode}")+":";return(e.source||e.id||e.target||a)&&(i+=x.maybeCapture(a,"source",e.source,".*?")+" starts using "),(e.ability||e.target||a)&&(i+=x.maybeCapture(a,"ability",e.ability,".*?")+" on "),(e.target||a)&&(i+=x.maybeCapture(a,"target",e.target,".*?")+"\\."),x.parse(i)}static ability(t){void 0===t&&(t={}),x.validateParams(t,"ability",e);const a=x.trueIfUndefined(t.capture);let i=x.maybeCapture(a,"timestamp","\\y{Timestamp}")+" 1[56]:"+x.maybeCapture(a,"sourceId","\\y{ObjectId}")+":"+x.maybeCapture(a,"source",t.source,"[^:]*?")+":";return(t.id||t.ability||t.target||t.targetId||a)&&(i+=x.maybeCapture(a,"id",t.id,"\\y{AbilityCode}")+":"),(t.ability||t.target||t.targetId||a)&&(i+=x.maybeCapture(a,"ability",t.ability,"[^:]*?")+":"),(t.target||t.targetId||a)&&(i+=x.maybeCapture(a,"targetId","\\y{ObjectId}")+":"),(t.target||a)&&(i+=x.maybeCapture(a,"target",t.target,"[^:]*?")+":"),x.parse(i)}static abilityFull(t){void 0===t&&(t={}),x.validateParams(t,"abilityFull",a);const e=x.trueIfUndefined(t.capture),i=x.maybeCapture(e,"timestamp","\\y{Timestamp}")+" 1[56]:"+x.maybeCapture(e,"sourceId",t.sourceId,"\\y{ObjectId}")+":"+x.maybeCapture(e,"source",t.source,"[^:]*?")+":"+x.maybeCapture(e,"id",t.id,"\\y{AbilityCode}")+":"+x.maybeCapture(e,"ability",t.ability,"[^:]*?")+":"+x.maybeCapture(e,"targetId",t.targetId,"\\y{ObjectId}")+":"+x.maybeCapture(e,"target",t.target,"[^:]*?")+":"+x.maybeCapture(e,"flags",t.flags,"[^:]*?")+":"+x.maybeCapture(e,"flag0",t.flag0,"[^:]*?")+":"+x.maybeCapture(e,"flag1",t.flag1,"[^:]*?")+":"+x.maybeCapture(e,"flag2",t.flag2,"[^:]*?")+":"+x.maybeCapture(e,"flag3",t.flag3,"[^:]*?")+":"+x.maybeCapture(e,"flag4",t.flag4,"[^:]*?")+":"+x.maybeCapture(e,"flag5",t.flag5,"[^:]*?")+":"+x.maybeCapture(e,"flag6",t.flag6,"[^:]*?")+":"+x.maybeCapture(e,"flag7",t.flag7,"[^:]*?")+":"+x.maybeCapture(e,"flag8",t.flag8,"[^:]*?")+":"+x.maybeCapture(e,"flag9",t.flag9,"[^:]*?")+":"+x.maybeCapture(e,"flag10",t.flag10,"[^:]*?")+":"+x.maybeCapture(e,"flag11",t.flag11,"[^:]*?")+":"+x.maybeCapture(e,"flag12",t.flag12,"[^:]*?")+":"+x.maybeCapture(e,"flag13",t.flag13,"[^:]*?")+":"+x.maybeCapture(e,"flag14",t.flag13,"[^:]*?")+":"+x.optional(x.maybeCapture(e,"targetHp",t.targetHp,"\\y{Float}"))+":"+x.optional(x.maybeCapture(e,"targetMaxHp",t.targetMaxHp,"\\y{Float}"))+":"+x.optional(x.maybeCapture(e,"targetMp",t.targetMp,"\\y{Float}"))+":"+x.optional(x.maybeCapture(e,"targetMaxMp",t.targetMaxMp,"\\y{Float}"))+":"+x.optional("\\y{Float}")+":"+x.optional("\\y{Float}")+":"+x.optional(x.maybeCapture(e,"targetX",t.targetX,"\\y{Float}"))+":"+x.optional(x.maybeCapture(e,"targetY",t.targetY,"\\y{Float}"))+":"+x.optional(x.maybeCapture(e,"targetZ",t.targetZ,"\\y{Float}"))+":"+x.optional(x.maybeCapture(e,"targetHeading",t.targetHeading,"\\y{Float}"))+":"+x.maybeCapture(e,"hp",t.hp,"\\y{Float}")+":"+x.maybeCapture(e,"maxHp",t.maxHp,"\\y{Float}")+":"+x.maybeCapture(e,"mp",t.mp,"\\y{Float}")+":"+x.maybeCapture(e,"maxMp",t.maxMp,"\\y{Float}")+":\\y{Float}:\\y{Float}:"+x.maybeCapture(e,"x",t.x,"\\y{Float}")+":"+x.maybeCapture(e,"y",t.y,"\\y{Float}")+":"+x.maybeCapture(e,"z",t.z,"\\y{Float}")+":"+x.maybeCapture(e,"heading",t.heading,"\\y{Float}")+":.*?$";return x.parse(i)}static headMarker(t){void 0===t&&(t={}),x.validateParams(t,"headMarker",i);const e=x.trueIfUndefined(t.capture),a=x.maybeCapture(e,"timestamp","\\y{Timestamp}")+" 1B:"+x.maybeCapture(e,"targetId",t.targetId,"\\y{ObjectId}")+":"+x.maybeCapture(e,"target",t.target,"[^:]*?")+":....:....:"+x.maybeCapture(e,"id",t.id,"....")+":";return x.parse(a)}static addedCombatant(t){void 0===t&&(t={}),x.validateParams(t,"addedCombatant",s);const e=x.trueIfUndefined(t.capture),a=x.maybeCapture(e,"timestamp","\\y{Timestamp}")+" 03:\\y{ObjectId}:Added new combatant "+x.maybeCapture(e,"name",t.name,".*?")+"\\.";return x.parse(a)}static addedCombatantFull(t){void 0===t&&(t={}),x.validateParams(t,"addedCombatantFull",n);const e=x.trueIfUndefined(t.capture),a=x.maybeCapture(e,"timestamp","\\y{Timestamp}")+" 03:"+x.maybeCapture(e,"id",t.id,"\\y{ObjectId}")+":Added new combatant "+x.maybeCapture(e,"name",t.name,"[^:]*?")+"\\. {2}Job: "+x.maybeCapture(e,"job",t.job,"[^:]*?")+" Level: "+x.maybeCapture(e,"level",t.level,"[^:]*?")+" Max HP: "+x.maybeCapture(e,"hp",t.hp,"[0-9]+")+"..*?Pos: \\("+x.maybeCapture(e,"x",t.x,"\\y{Float}")+","+x.maybeCapture(e,"y",t.y,"\\y{Float}")+","+x.maybeCapture(e,"z",t.z,"\\y{Float}")+"\\)(?: \\("+x.maybeCapture(e,"npcId",t.npcId,".*?")+"\\))?\\.";return x.parse(a)}static removingCombatant(t){void 0===t&&(t={}),x.validateParams(t,"removingCombatant",r);const e=x.trueIfUndefined(t.capture),a=x.maybeCapture(e,"timestamp","\\y{Timestamp}")+" 04:"+x.maybeCapture(e,"id","\\y{ObjectId}")+":Removing combatant "+x.maybeCapture(e,"name",t.name,".*?")+"\\..*?Max HP: "+x.maybeCapture(e,"hp",t.hp,"[0-9]+")+"."+x.optional(".*?Pos: \\("+x.maybeCapture(e,"x",t.x,"\\y{Float}")+","+x.maybeCapture(e,"y",t.y,"\\y{Float}")+","+x.maybeCapture(e,"z",t.z,"\\y{Float}")+"\\)");return x.parse(a)}static gainsEffect(t){void 0===t&&(t={}),x.validateParams(t,"gainsEffect",l);const e=x.trueIfUndefined(t.capture),a=x.maybeCapture(e,"timestamp","\\y{Timestamp}")+" 1A:"+x.maybeCapture(e,"targetId",t.targetId,"\\y{ObjectId}")+":"+x.maybeCapture(e,"target",t.target,".*?")+" gains the effect of "+x.maybeCapture(e,"effect",t.effect,".*?")+" from "+x.maybeCapture(e,"source",t.source,".*?")+" for "+x.maybeCapture(e,"duration",t.duration,"\\y{Float}")+" Seconds\\.";return x.parse(a)}static statusEffectExplicit(t){void 0===t&&(t={}),x.validateParams(t,"statusEffectExplicit",o);const e=x.trueIfUndefined(t.capture),a=".*?:",i=x.maybeCapture(e,"timestamp","\\y{Timestamp}")+" 26:"+x.maybeCapture(e,"targetId",t.targetId,"\\y{ObjectId}")+":"+x.maybeCapture(e,"target",t.target,"[^:]*?")+":[0-9A-F]{0,6}"+x.maybeCapture(e,"job",t.job,"[0-9A-F]{0,2}")+":"+x.maybeCapture(e,"hp",t.hp,"\\y{Float}")+":"+x.maybeCapture(e,"maxHp",t.maxHp,"\\y{Float}")+":"+x.maybeCapture(e,"mp",t.mp,"\\y{Float}")+":"+x.maybeCapture(e,"maxMp",t.maxMp,"\\y{Float}")+":"+a+a+x.optional(x.maybeCapture(e,"x",t.x,"\\y{Float}"))+":"+x.optional(x.maybeCapture(e,"y",t.y,"\\y{Float}"))+":"+x.optional(x.maybeCapture(e,"z",t.z,"\\y{Float}"))+":"+x.optional(x.maybeCapture(e,"heading",t.heading,"\\y{Float}"))+":"+x.maybeCapture(e,"data0",t.data0,"[^:]*?")+":"+x.maybeCapture(e,"data1",t.data1,"[^:]*?")+":"+x.optional(x.maybeCapture(e,"data2",t.data2,"[^:]*?")+":")+x.optional(x.maybeCapture(e,"data3",t.data3,"[^:]*?")+":")+x.optional(x.maybeCapture(e,"data4",t.data4,"[^:]*?")+":");return x.parse(i)}static losesEffect(t){void 0===t&&(t={}),x.validateParams(t,"losesEffect",d);const e=x.trueIfUndefined(t.capture),a=x.maybeCapture(e,"timestamp","\\y{Timestamp}")+" 1E:"+x.maybeCapture(e,"targetId",t.targetId,"\\y{ObjectId}")+":"+x.maybeCapture(e,"target",t.target,".*?")+" loses the effect of "+x.maybeCapture(e,"effect",t.effect,".*?")+" from "+x.maybeCapture(e,"source",t.source,".*?")+"\\.";return x.parse(a)}static tether(t){void 0===t&&(t={}),x.validateParams(t,"tether",p);const e=x.trueIfUndefined(t.capture),a=x.maybeCapture(e,"timestamp","\\y{Timestamp}")+" 23:"+x.maybeCapture(e,"sourceId",t.sourceId,"\\y{ObjectId}")+":"+x.maybeCapture(e,"source",t.source,"[^:]*?")+":"+x.maybeCapture(e,"targetId",t.targetId,"\\y{ObjectId}")+":"+x.maybeCapture(e,"target",t.target,"[^:]*?")+":....:....:"+x.maybeCapture(e,"id",t.id,"....")+":";return x.parse(a)}static wasDefeated(t){void 0===t&&(t={}),x.validateParams(t,"wasDefeated",m);const e=x.trueIfUndefined(t.capture),a=x.maybeCapture(e,"timestamp","\\y{Timestamp}")+" 19:"+x.maybeCapture(e,"target",t.target,".*?")+" was defeated by "+x.maybeCapture(e,"source",t.source,".*?")+"\\.";return x.parse(a)}static hasHP(t){void 0===t&&(t={}),x.validateParams(t,"hasHP",c);const e=x.trueIfUndefined(t.capture),a=x.maybeCapture(e,"timestamp","\\y{Timestamp}")+" 0D:"+x.maybeCapture(e,"name",t.name,".*?")+" HP at "+x.maybeCapture(e,"hp",t.hp,"\\d+")+"%";return x.parse(a)}static echo(t){return void 0===t&&(t={}),x.validateParams(t,"echo",h),x.gameLog({line:t.line,capture:t.capture,code:"0038"})}static dialog(t){void 0===t&&(t={}),x.validateParams(t,"dialog",g);const e=x.trueIfUndefined(t.capture),a=x.maybeCapture(e,"timestamp","\\y{Timestamp}")+" 00:"+x.maybeCapture(e,"code","0044")+":"+x.maybeCapture(e,"name",t.name,".*?")+":"+x.maybeCapture(e,"line",t.line,".*")+"$";return x.parse(a)}static message(t){return void 0===t&&(t={}),x.validateParams(t,"message",f),x.gameLog({line:t.line,capture:t.capture,code:"0839"})}static gameLog(t){void 0===t&&(t={}),x.validateParams(t,"gameLog",y);const e=x.trueIfUndefined(t.capture),a=x.maybeCapture(e,"timestamp","\\y{Timestamp}")+" 00:"+x.maybeCapture(e,"code",t.code,"....")+":"+x.maybeCapture(e,"line",t.line,".*")+"$";return x.parse(a)}static gameNameLog(t){void 0===t&&(t={}),x.validateParams(t,"gameNameLog",v);const e=x.trueIfUndefined(t.capture),a=x.maybeCapture(e,"timestamp","\\y{Timestamp}")+" 00:"+x.maybeCapture(e,"code",t.code,"....")+":"+x.maybeCapture(e,"name",t.name,"[^:]*")+":"+x.maybeCapture(e,"line",t.line,".*")+"$";return x.parse(a)}static statChange(t){void 0===t&&(t={}),x.validateParams(t,"statChange",u);const e=x.trueIfUndefined(t.capture),a=x.maybeCapture(e,"timestamp","\\y{Timestamp}")+" 0C:Player Stats: "+x.maybeCapture(e,"job",t.job,"\\d+")+":"+x.maybeCapture(e,"strength",t.strength,"\\d+")+":"+x.maybeCapture(e,"dexterity",t.dexterity,"\\d+")+":"+x.maybeCapture(e,"vitality",t.vitality,"\\d+")+":"+x.maybeCapture(e,"intelligence",t.intelligence,"\\d+")+":"+x.maybeCapture(e,"mind",t.mind,"\\d+")+":"+x.maybeCapture(e,"piety",t.piety,"\\d+")+":"+x.maybeCapture(e,"attackPower",t.attackPower,"\\d+")+":"+x.maybeCapture(e,"directHit",t.directHit,"\\d+")+":"+x.maybeCapture(e,"criticalHit",t.criticalHit,"\\d+")+":"+x.maybeCapture(e,"attackMagicPotency",t.attackMagicPotency,"\\d+")+":"+x.maybeCapture(e,"healMagicPotency",t.healMagicPotency,"\\d+")+":"+x.maybeCapture(e,"determination",t.determination,"\\d+")+":"+x.maybeCapture(e,"skillSpeed",t.skillSpeed,"\\d+")+":"+x.maybeCapture(e,"spellSpeed",t.spellSpeed,"\\d+")+":0:"+x.maybeCapture(e,"tenacity",t.tenacity,"\\d+");return x.parse(a)}static changeZone(t){void 0===t&&(t={}),x.validateParams(t,"changeZone",b);const e=x.trueIfUndefined(t.capture),a=x.maybeCapture(e,"timestamp","\\y{Timestamp}")+" 01:Changed Zone to "+x.maybeCapture(e,"name",t.name,".*?")+"\\.";return x.parse(a)}static network6d(t){void 0===t&&(t={}),x.validateParams(t,"network6d",C);const e=x.trueIfUndefined(t.capture),a=x.maybeCapture(e,"timestamp","\\y{Timestamp}")+" 21:"+x.maybeCapture(e,"instance",t.instance,".*?")+":"+x.maybeCapture(e,"command",t.command,".*?")+":"+x.maybeCapture(e,"data0",t.data0,".*?")+":"+x.maybeCapture(e,"data1",t.data1,".*?")+":"+x.maybeCapture(e,"data2",t.data2,".*?")+":"+x.maybeCapture(e,"data3",t.data3,".*?")+"$";return x.parse(a)}static maybeCapture(t,e,a,i){return a||(a=i),a=x.anyOf(a),t?x.namedCapture(e,a):a}static optional(t){return`(?:${t})?`}static namedCapture(t,e){return t.includes(">")&&console.error('"'+t+'" contains ">".'),t.includes("<")&&console.error('"'+t+'" contains ">".'),"(?<"+t+">"+e+")"}static anyOf(...t){let e=[];return e=1===t.length?Array.isArray(t[0])?t[0]:t[0]?[t[0]]:[]:t,(t=>`(?:${t.map((t=>t instanceof RegExp?t.source:t)).join("|")})`)(e)}static parse(t){const e={Timestamp:"^.{14}",NetTimestamp:".{33}",NetField:"(?:[^|]*\\|)",LogType:"[0-9A-Fa-f]{2}",AbilityCode:"[0-9A-Fa-f]{1,8}",ObjectId:"[0-9A-F]{8}",Name:"(?:[^\\s:|]+(?: [^\\s:|]+)?|)",Float:"-?[0-9]+(?:[.,][0-9]+)?(?:E-?[0-9]+)?"};let a="i";return t instanceof RegExp&&(a+=(t.global?"g":"")+(t.multiline?"m":""),t=t.source),t=t.replace(/\\y\{(.*?)\}/g,((t,a)=>e[a]||t)),new RegExp(t,a)}static parseGlobal(t){const e=x.parse(t);let a="gi";return t instanceof RegExp&&(a+=t.multiline?"m":""),new RegExp(e.source,a)}static trueIfUndefined(t){return void 0===t||!!t}static validateParams(t,e,a){if(null===t)return;if("object"!=typeof t)return;const i=Object.keys(t);for(let t=0;t<i.length;++t){const s=i[t];if(s&&!a.includes(s))throw new Error(`${e}: invalid parameter '${s}'.  Valid params: ${JSON.stringify(a)}`)}}}const I=new RegExp("^\\^\\^"),S=["ability","name","source","target","line"],N=(t,e,a)=>{var i,s,n,r,l,o;t=null!=t?t:{};const d=[];for(const t of Object.values(a))"object"==typeof t&&d.push(t.field);x.validateParams(t,e,["capture",...d]);const u=x.trueIfUndefined(t.capture),p=Object.keys(a);let m;if(u)m=p[p.length-1];else{m=0;for(const e of p){if("object"!=typeof(null!==(i=a[e])&&void 0!==i?i:{}))continue;const n=null===(s=a[e])||void 0===s?void 0:s.field;n&&n in t&&(m=e)}}const c=Object.keys(t).filter((t=>S.includes(t)));let h=M.flagTranslationsNeeded&&c.length>0?"^^":"^",g=-1;for(const i in a){const s=parseInt(i),d=s-g-1;1===d?h+="\\y{NetField}":d>1&&(h+=`\\y{NetField}{${d}}`),g=s;const p=a[s];if("object"!=typeof p)throw new Error(`${e}: invalid value: ${JSON.stringify(p)}`);const c=null===(n=a[s])||void 0===n?void 0:n.field,f=null!==(o=null===(l=null===(r=a[s])||void 0===r?void 0:r.value)||void 0===l?void 0:l.toString())&&void 0!==o?o:"[^|]*";if(h+=c?x.maybeCapture(u,c,t[c],f)+"\\|":f+"\\|",s>=(null!=m?m:0))break}return x.parse(h)};class M{static setFlagTranslationsNeeded(t){M.flagTranslationsNeeded=t}static doesNetRegexNeedTranslation(t){console.assert(M.flagTranslationsNeeded);const e="string"==typeof t?t:t.source;return!!I.exec(e)}static startsUsing(t){return N(t,"startsUsing",{0:{field:"type",value:"20"},1:{field:"timestamp"},2:{field:"sourceId"},3:{field:"source"},4:{field:"id"},5:{field:"ability"},6:{field:"targetId"},7:{field:"target"},8:{field:"castTime"}})}static ability(t){return N(t,"ability",{0:{field:"type",value:"2[12]"},1:{field:"timestamp"},2:{field:"sourceId"},3:{field:"source"},4:{field:"id"},5:{field:"ability"},6:{field:"targetId"},7:{field:"target"}})}static abilityFull(t){return N(t,"abilityFull",{0:{field:"type",value:"2[12]"},1:{field:"timestamp"},2:{field:"sourceId"},3:{field:"source"},4:{field:"id"},5:{field:"ability"},6:{field:"targetId"},7:{field:"target"},8:{field:"flags"},9:{field:"damage"},24:{field:"targetCurrentHp"},25:{field:"targetMaxHp"},40:{field:"x"},41:{field:"y"},42:{field:"z"},43:{field:"heading"}})}static headMarker(t){return N(t,"headMarker",{0:{field:"type",value:"27"},1:{field:"timestamp"},2:{field:"targetId"},3:{field:"target"},6:{field:"id"}})}static addedCombatant(t){return N(t,"addedCombatant",{0:{field:"type",value:"03"},1:{field:"timestamp"},2:{field:"id"},3:{field:"name"}})}static addedCombatantFull(t){return N(t,"addedCombatantFull",{0:{field:"type",value:"03"},1:{field:"timestamp"},2:{field:"id"},3:{field:"name"},4:{field:"job"},5:{field:"level"},6:{field:"ownerId"},8:{field:"world"},9:{field:"npcNameId"},10:{field:"npcBaseId"},11:{field:"currentHp"},12:{field:"hp"},17:{field:"x"},18:{field:"y"},19:{field:"z"},20:{field:"heading"}})}static removingCombatant(t){return N(t,"removingCombatant",{0:{field:"type",value:"04"},1:{field:"timestamp"},2:{field:"id"},3:{field:"name"},12:{field:"hp"}})}static gainsEffect(t){return N(t,"gainsEffect",{0:{field:"type",value:"26"},1:{field:"timestamp"},2:{field:"effectId"},3:{field:"effect"},4:{field:"duration"},5:{field:"sourceId"},6:{field:"source"},7:{field:"targetId"},8:{field:"target"},9:{field:"count"}})}static statusEffectExplicit(t){return N(t,"statusEffectExplicit",{0:{field:"type",value:"38"},1:{field:"timestamp"},2:{field:"targetId"},3:{field:"target"},5:{field:"hp"},6:{field:"maxHp"},11:{field:"x"},12:{field:"y"},13:{field:"z"},14:{field:"heading"},15:{field:"data0"},16:{field:"data1"},17:{field:"data2"},18:{field:"data3"},19:{field:"data4"}})}static losesEffect(t){return N(t,"losesEffect",{0:{field:"type",value:"30"},1:{field:"timestamp"},2:{field:"effectId"},3:{field:"effect"},5:{field:"sourceId"},6:{field:"source"},7:{field:"targetId"},8:{field:"target"},9:{field:"count"}})}static tether(t){return N(t,"tether",{0:{field:"type",value:"35"},1:{field:"timestamp"},2:{field:"sourceId"},3:{field:"source"},4:{field:"targetId"},5:{field:"target"},8:{field:"id"}})}static wasDefeated(t){return N(t,"wasDefeated",{0:{field:"type",value:"25"},1:{field:"timestamp"},2:{field:"targetId"},3:{field:"target"},4:{field:"sourceId"},5:{field:"source"}})}static echo(t){return void 0===t&&(t={}),x.validateParams(t,"echo",["type","timestamp","code","name","line","capture"]),t.code="0038",M.gameLog(t)}static dialog(t){return void 0===t&&(t={}),x.validateParams(t,"dialog",["type","timestamp","code","name","line","capture"]),t.code="0044",M.gameLog(t)}static message(t){return void 0===t&&(t={}),x.validateParams(t,"message",["type","timestamp","code","name","line","capture"]),t.code="0839",M.gameLog(t)}static gameLog(t){return N(t,"gameLog",{0:{field:"type",value:"00"},1:{field:"timestamp"},2:{field:"code"},3:{field:"name"},4:{field:"line"}})}static gameNameLog(t){return M.gameLog(t)}static statChange(t){return N(t,"statChange",{0:{field:"type",value:"12"},1:{field:"timestamp"},2:{field:"job"},3:{field:"strength"},4:{field:"dexterity"},5:{field:"vitality"},6:{field:"intelligence"},7:{field:"mind"},8:{field:"piety"},9:{field:"attackPower"},10:{field:"directHit"},11:{field:"criticalHit"},12:{field:"attackMagicPotency"},13:{field:"healMagicPotency"},14:{field:"determination"},15:{field:"skillSpeed"},16:{field:"spellSpeed"},18:{field:"tenacity"}})}static changeZone(t){return N(t,"changeZone",{0:{field:"type",value:"01"},1:{field:"timestamp"},2:{field:"id"},3:{field:"name"}})}static network6d(t){return N(t,"network6d",{0:{field:"type",value:"33"},1:{field:"timestamp"},2:{field:"instance"},3:{field:"command"},4:{field:"data0"},5:{field:"data1"},6:{field:"data2"},7:{field:"data3"}})}static nameToggle(t){return N(t,"nameToggle",{0:{field:"type",value:"34"},1:{field:"timestamp"},2:{field:"id"},3:{field:"name"},6:{field:"toggle"}})}}M.flagTranslationsNeeded=!1;const P={countdownStart:{en:"Battle commencing in (?<time>\\y{Float}) seconds! \\((?<player>.*?)\\)",de:"Noch (?<time>\\y{Float}) Sekunden bis Kampfbeginn! \\((?<player>.*?)\\)",fr:"Début du combat dans (?<time>\\y{Float}) secondes[ ]?! \\((?<player>.*?)\\)",ja:"戦闘開始まで(?<time>\\y{Float})秒！ \\((?<player>.*?)\\)",cn:"距离战斗开始还有(?<time>\\y{Float})秒！ （(?<player>.*?)）",ko:"전투 시작 (?<time>\\y{Float})초 전! \\((?<player>.*?)\\)"},countdownEngage:{en:"Engage!",de:"Start!",fr:"À l'attaque[ ]?!",ja:"戦闘開始！",cn:"战斗开始！",ko:"전투 시작!"},countdownCancel:{en:"Countdown canceled by (?<player>\\y{Name})",de:"(?<player>\\y{Name}) hat den Countdown abgebrochen",fr:"Le compte à rebours a été interrompu par (?<player>\\y{Name})[ ]?\\.",ja:"(?<player>\\y{Name})により、戦闘開始カウントがキャンセルされました。",cn:"(?<player>\\y{Name})取消了战斗开始倒计时。",ko:"(?<player>\\y{Name}) 님이 초읽기를 취소했습니다\\."},areaSeal:{en:"(?<area>.*?) will be sealed off in (?<time>\\y{Float}) seconds!",de:"Noch (?<time>\\y{Float}) Sekunden, bis sich (?<area>.*?) schließt",fr:"Fermeture (?<area>.*?) dans (?<time>\\y{Float}) secondes[ ]?\\.",ja:"(?<area>.*?)の封鎖まであと(?<time>\\y{Float})秒",cn:"距(?<area>.*?)被封锁还有(?<time>\\y{Float})秒",ko:"(?<time>\\y{Float})초 후에 (?<area>.*?)(이|가) 봉쇄됩니다\\."},areaUnseal:{en:"(?<area>.*?) is no longer sealed.",de:"(?<area>.*?) öffnet sich erneut.",fr:"Ouverture (?<area>.*?)[ ]?!",ja:"(?<area>.*?)の封鎖が解かれた……",cn:"(?<area>.*?)的封锁解除了",ko:"(?<area>.*?)의 봉쇄가 해제되었습니다\\."},craftingStart:{en:"You begin synthesizing (?<count>(an?|\\d+) )?(?<recipe>.*)\\.",de:"Du hast begonnen, durch Synthese (?<count>(ein(e|es|em|er)?|\\d+) )?(?<recipe>.*) herzustellen\\.",fr:"Vous commencez à fabriquer (?<count>(une?|\\d+) )?(?<recipe>.*)\\.",ja:"(?<player>\\y{Name})は(?<recipe>.*)(×(?<count>\\d+))?の製作を開始した。",cn:"(?<player>\\y{Name})开始制作“(?<recipe>.*)”(×(?<count>\\d+))?。",ko:"(?<recipe>.*)(×(?<count>\\d+)개)? 제작을 시작합니다\\."},trialCraftingStart:{en:"You begin trial synthesis of (?<recipe>.*)\\.",de:"Du hast mit der Testsynthese von (?<recipe>.*) begonnen\\.",fr:"Vous commencez une synthèse d'essai pour une? (?<recipe>.*)\\.",ja:"(?<player>\\y{Name})は(?<recipe>.*)の製作練習を開始した。",cn:"(?<player>\\y{Name})开始练习制作(?<recipe>.*)。",ko:"(?<recipe>.*) 제작 연습을 시작합니다\\."},craftingFinish:{en:"You synthesize (?<count>(an?|\\d+) )?(?<recipe>.*)()?\\.",de:"Du hast erfolgreich (?<count>(ein(e|es|em|er)?|\\d+) )?(?<recipe>.*)()? hergestellt\\.",fr:"Vous fabriquez (?<count>(une?|\\d+) )?(?<recipe>.*)()?\\.",ja:"(?<player>\\y{Name})は(?<recipe>.*)()?(×(?<count>\\d+))?を完成させた！",cn:"(?<player>\\y{Name})制作“(?<recipe>.*)()?”(×(?<count>\\d+))?成功！",ko:"(?<player>\\y{Name}) 님이 (?<recipe>.*)()?(×(?<count>\\d+)개)?(을|를) 완성했습니다!"},trialCraftingFinish:{en:"Your trial synthesis of (?<recipe>.*) proved a success!",de:"Die Testsynthese von (?<recipe>.*) war erfolgreich!",fr:"Votre synthèse d'essai pour fabriquer (?<recipe>.*) a été couronnée de succès!",ja:"(?<player>\\y{Name})は(?<recipe>.*)の製作練習に成功した！",cn:"(?<player>\\y{Name})练习制作(?<recipe>.*)成功了！",ko:"(?<recipe>.*) 제작 연습에 성공했습니다!"},craftingFail:{en:"Your synthesis fails!",de:"Deine Synthese ist fehlgeschlagen!",fr:"La synthèse échoue\\.{3}",ja:"(?<player>\\y{Name})は製作に失敗した……",cn:"(?<player>\\y{Name})制作失败了……",ko:"제작에 실패했습니다……\\."},trialCraftingFail:{en:"Your trial synthesis of (?<recipe>.*) failed\\.{3}",de:"Die Testsynthese von (?<recipe>.*) ist fehlgeschlagen\\.{3}",fr:"Votre synthèse d'essai pour fabriquer (?<recipe>.*) s'est soldée par un échec\\.{3}",ja:"(?<player>\\y{Name})は(?<recipe>.*)の製作練習に失敗した……",cn:"(?<player>\\y{Name})练习制作(?<recipe>.*)失败了……",ko:"(?<recipe>.*) 제작 연습에 실패했습니다……\\."},craftingCancel:{en:"You cancel the synthesis\\.",de:"Du hast die Synthese abgebrochen\\.",fr:"La synthèse est annulée\\.",ja:"(?<player>\\y{Name})は製作を中止した。",cn:"(?<player>\\y{Name})中止了制作作业。",ko:"제작을 중지했습니다\\."},trialCraftingCancel:{en:"You abandoned trial synthesis\\.",de:"Testsynthese abgebrochen\\.",fr:"Vous avez interrompu la synthèse d'essai\\.",ja:"(?<player>\\y{Name})は製作練習を中止した。",cn:"(?<player>\\y{Name})停止了练习。",ko:"제작 연습을 중지했습니다\\."}},w=new class{get localeRegex(){return this.regexes||(this.regexes=this.buildLocaleRegexes(P,(t=>x.gameLog({line:t+".*?"})))),this.regexes}get localeNetRegex(){return this.netRegexes||(this.netRegexes=this.buildLocaleRegexes(P,(t=>M.gameLog({line:t+"[^|]*?"})))),this.netRegexes}buildLocaleRegexes(t,e){return Object.fromEntries(Object.entries(t).map((([t,a])=>[t,this.buildLocaleRegex(a,e)])))}buildLocaleRegex(t,e){const a=e(t.en);return{en:a,de:t.de?e(t.de):a,fr:t.fr?e(t.fr):a,ja:t.ja?e(t.ja):a,cn:t.cn?e(t.cn):a,ko:t.ko?e(t.ko):a}}},E=(w.localeRegex,w.localeNetRegex);class F{static cloneData(t,e=["options","party"]){const a={};for(const i in t)e.includes(i)||("object"==typeof t[i]?a[i]=F._cloneData(t[i]):a[i]=t[i]);return a}static _cloneData(t){if("object"==typeof t){if(Array.isArray(t)){const e=[];for(let a=0;a<t.length;++a)e[a]=F._cloneData(t[a]);return e}if(null===t)return null;if(t instanceof RegExp)return new RegExp(t);const e={};for(const a in t)e[a]=F._cloneData(t[a]);return e}return t}static timeToString(t,e=!0){const a=t<0?"-":"",i=(t=Math.abs(t))%1e3,s=(t%6e4-i)/1e3,n=`00${i}`.substr(-3),r=`0${s}`.substr(-2);return a+("0"+((t%36e5-i)/1e3-s)/60).substr(-2)+":"+r+(e?"."+n:"")}static timeToDateString(t){return this.dateObjectToDateString(new Date(t))}static dateObjectToDateString(t){return`${t.getFullYear()}-${F.zeroPad((t.getMonth()+1).toString())}-${F.zeroPad(t.getDate().toString())}`}static timeToTimeString(t,e=!1){return this.dateObjectToTimeString(new Date(t),e)}static dateObjectToTimeString(t,e=!1){let a=`${F.zeroPad(t.getHours().toString())}:${F.zeroPad(t.getMinutes().toString())}:${F.zeroPad(t.getSeconds().toString())}`;return e&&(a+=`.${t.getMilliseconds()}`),a}static msToDuration(t){return F.timeToString(t,!1).replace(":","m")+"s"}static dateTimeToString(t,e=!1){const a=new Date(t);return`${this.dateObjectToDateString(a)} ${this.dateObjectToTimeString(a,e)}`}static zeroPad(t,e=2){return(""+t).padStart(e,"0")}static properCase(t){return t.replace(/([^\W_]+[^\s-]*) */g,(t=>t.charAt(0).toUpperCase()+t.substr(1).toLowerCase()))}static spacePadLeft(t,e){return t.padStart(e," ")}static doesLineMatch(t,e){if(e instanceof RegExp)return e.exec(t);for(const a in e){const i=a,s=e[i].exec(t);if(s)return s.groups&&(s.groups.language=i),s}return null}static matchStart(t){var e,a,i,s;let n;return n=F.doesLineMatch(t,F.countdownRegexes),n?(null!==(e=n.groups)&&void 0!==e||(n.groups={}),n.groups.StartIn=(1e3*parseInt(null!==(a=n.groups.time)&&void 0!==a?a:"0")).toString(),n.groups.StartType="Countdown",n):(n=F.doesLineMatch(t,F.sealRegexes),n?(null!==(i=n.groups)&&void 0!==i||(n.groups={}),n.groups.StartIn="0",n.groups.StartType="Seal",n):(n=F.doesLineMatch(t,F.engageRegexes),n?(null!==(s=n.groups)&&void 0!==s||(n.groups={}),n.groups.StartIn="0",n.groups.StartType="Engage",n):void 0))}static matchEnd(t){var e,a,i,s;let n;return n=F.doesLineMatch(t,F.winRegex),n?(null!==(e=n.groups)&&void 0!==e||(n.groups={}),n.groups.EndType="Win",n):(n=F.doesLineMatch(t,F.wipeRegex),n?(null!==(a=n.groups)&&void 0!==a||(n.groups={}),n.groups.EndType="Wipe",n):(n=F.doesLineMatch(t,F.cactbotWipeRegex),n?(null!==(i=n.groups)&&void 0!==i||(n.groups={}),n.groups.EndType="Cactbot Wipe",n):(n=F.doesLineMatch(t,F.unsealRegexes),n?(null!==(s=n.groups)&&void 0!==s||(n.groups={}),n.groups.EndType="Unseal",n):void 0)))}}F.sealRegexes=E.areaSeal,F.engageRegexes=E.countdownEngage,F.countdownRegexes=E.countdownStart,F.unsealRegexes=E.areaUnseal,F.wipeRegex=M.network6d({command:"40000010"}),F.winRegex=M.network6d({command:"40000003"}),F.cactbotWipeRegex=M.echo({line:"cactbot wipe.*?"});class T{constructor(t,e){this.id=t,this.name="",this.server="",this.setName(e),this.states={},this.significantStates=[],this.latestTimestamp=null,this.job=null,this.level=null}setName(t){if(""===t)return;const e=t.split("(");this.name=e[0],e.length>1&&(this.server=e[1].replace(/\)$/,""))}hasState(t){return void 0!==this.states[t]}pushState(t,e){this.states[t]=e,this.latestTimestamp=t,this.significantStates.includes(t)||this.significantStates.push(t)}nextSignificantState(t){const e=this.significantStates.indexOf(t),a=this.significantStates.length-1;if(e>=0&&e<a)return this.states[this.significantStates[e+1]];if(e===a||t>this.significantStates[a])return this.states[this.significantStates[a]];for(let e=0;e<this.significantStates.length;++e)if(this.significantStates[e]>t)return this.states[this.significantStates[e]];return this.states[this.significantStates[this.significantStates.length-1]]}pushPartialState(t,e){void 0!==this.states[t]?Object.keys(this.states[t]).filter((t=>void 0!==e[t])).forEach((a=>{this.states[t][a]="Visible"===a?e[a]:Number(e[a])})):(this.states[t]=this.states[this.latestTimestamp].partialClone(e),this.latestTimestamp=Math.max(this.latestTimestamp,t));const a=this.significantStates[this.significantStates.length-1],i=JSON.stringify(this.states[a]),s=JSON.stringify(this.states[t]);a!==t&&s!==i&&this.significantStates.push(t)}getState(t){if(void 0!==this.states[t])return this.states[t];if(t<this.significantStates[0])return this.states[this.significantStates[0]];let e=0;for(;e<this.significantStates.length;++e)if(this.significantStates[e]>t)return this.states[this.significantStates[e-1]];return this.states[this.significantStates[e-1]]}}class L{static getJob(t){if(!L.abilityMatchRegex.test(t))return null;t=Number("0x"+t);for(const e in L.abilities)if(L.abilities[e].includes(t))return e;return null}}L.abilities={PLD:[12959,12961,12964,12967,12968,12969,12970,12971,12972,12973,12974,12975,12976,12978,12980,12981,12982,12983,12984,12985,12986,12987,12988,12989,12991,12992,12993,12994,12996,13e3,13001,13006,14480,16457,16458,16459,16460,16461,17669,17671,17672,17691,17692,17693,17694,17866,18050,27,29,30,3538,3539,3540,3541,3542,4284,4285,4286,50207,50209,50246,50260,50261,50262,50263,50264,7382,7383,7384,7385,8746,8749,8750,8751,8752,8754,8755,8756],WAR:[16462,16463,16464,16465,17695,17696,17697,17698,17889,3549,3550,3551,3552,4289,4290,4291,49,50157,50218,50249,50265,50266,50267,50268,50269,51,52,7386,7387,7388,7389,8758,8761,8762,8763,8764,8765,8767,8768],DRK:[16466,16467,16468,16469,16470,16471,16472,17700,17701,17702,3617,3621,3623,3624,3625,3629,3632,3634,3636,3638,3639,3640,3641,3643,4303,4304,4305,4306,4307,4308,4309,4310,4311,4312,4680,50158,50159,50271,50272,50319,7390,7391,7392,7393,8769,8772,8773,8775,8776,8777,8778,8779],GNB:[17703,17704,17705,17706,17707,17708,17709,17710,17711,17712,17713,17714,17716,17717,17890,17891,16137,50320,16138,16139,16140,16141,16142,16143,16144,16145,16162,50257,16148,16149,16151,16152,50258,16153,16154,16146,16147,16150,16159,16160,16161,16155,16156,16157,16158,16163,16164,16165,50259],WHM:[12958,12962,12965,12997,13002,13003,13004,13005,131,136,137,139,140,14481,1584,16531,16532,16533,16534,16535,16536,17688,17689,17690,17789,17790,17791,17793,17794,17832,3568,3569,3570,3571,4296,4297,50181,50182,50196,50307,50308,50309,50310,7430,7431,7432,7433,8895,8896,8900,9621,127,133],SCH:[16537,16538,16539,16540,16541,16542,16543,16544,16545,16546,16547,16548,16550,16551,166,167,17215,17216,17795,17796,17797,17798,17802,17864,17865,17869,17870,17990,185,186,188,189,190,3583,3584,3585,3586,3587,4300,50184,50214,50311,50312,50313,50324,7434,7435,7436,7437,7438,7869,802,803,805,8904,8905,8909,9622],AST:[10027,10028,10029,16552,16553,16554,16555,16556,16557,16558,16559,17055,17151,17152,17804,17805,17806,17807,17809,17991,3590,3593,3594,3595,3596,3598,3599,3600,3601,3603,3604,3605,3606,3608,3610,3612,3613,3614,3615,4301,4302,4401,4402,4403,4404,4405,4406,4677,4678,4679,50122,50124,50125,50186,50187,50188,50189,50314,50315,50316,7439,7440,7441,7442,7443,7444,7445,7448,8324,8913,8914,8916,9629],MNK:[12960,12963,12966,12977,12979,12990,12995,12998,12999,14476,14478,16473,16474,16475,16476,17674,17675,17676,17677,17719,17720,17721,17722,17723,17724,17725,17726,3543,3545,3546,3547,4262,4287,4288,50160,50161,50245,50273,50274,63,70,71,7394,7395,7396,74,8780,8781,8782,8783,8784,8785,8787,8789,8925],DRG:[16477,16478,16479,16480,17728,17729,3553,3554,3555,3556,3557,4292,4293,50162,50163,50247,50275,50276,7397,7398,7399,7400,86,8791,8792,8793,8794,8795,8796,8797,8798,8799,8802,8803,8804,8805,8806,92,94,95,96,9640,75,78],NIN:[16488,16489,16491,16492,16493,17413,17414,17415,17416,17417,17418,17419,17420,17732,17733,17734,17735,17736,17737,17738,17739,2246,2259,2260,2261,2262,2263,2264,2265,2266,2267,2268,2269,2270,2271,2272,3563,3566,4295,50165,50166,50167,50250,50279,50280,7401,7402,7403,8807,8808,8809,8810,8812,8814,8815,8816,8820,9461],SAM:[16481,16482,16483,16484,16485,16486,16487,17740,17741,17742,17743,17744,50208,50215,50277,50278,7477,7478,7479,7480,7481,7482,7483,7484,7485,7486,7487,7488,7489,7490,7491,7492,7493,7494,7495,7496,7497,7498,7499,7501,7502,7855,7857,7867,8821,8822,8823,8824,8825,8826,8828,8829,8830,8831,8833],BRD:[10023,114,116,117,118,13007,14479,16494,16495,16496,17678,17679,17680,17681,17682,17745,17747,3558,3559,3560,3561,3562,4294,50168,50169,50282,50283,50284,50285,50286,50287,7404,7405,7406,7407,7408,7409,8836,8837,8838,8839,8841,8842,8843,8844,9625,106],MCH:[16497,16498,16499,16500,16501,16502,16503,16504,16766,16889,17206,17209,17749,17750,17751,17752,17753,17754,2864,2866,2868,2870,2872,2873,2874,2876,2878,2890,4276,4675,4676,50117,50119,50288,50289,50290,50291,50292,50293,50294,7410,7411,7412,7413,7414,7415,7416,7418,8848,8849,8850,8851,8853,8855],DNC:[17756,17757,17758,17759,17760,17761,17762,17763,17764,17765,17766,17767,17768,17769,17770,17771,17772,17773,17824,17825,17826,17827,17828,17829,18076,15989,15990,15993,15997,15999,16e3,16001,16002,16003,16191,16192,15991,15994,16007,50252,15995,15992,15996,16008,16010,50251,16015,16012,16006,18073,50253,16011,16009,50254,15998,16004,16193,16194,16195,16196,16013,16005,50255,50256,16014],BLM:[14477,153,154,158,159,162,16505,16506,16507,17683,17684,17685,17686,17687,17774,17775,3573,3574,3575,3576,3577,4298,50171,50172,50173,50174,50295,50296,50297,50321,50322,7419,7420,7421,7422,8858,8859,8860,8861,8862,8863,8864,8865,8866,8867,8869,9637,149,155,141,152],SMN:[16510,16511,16513,16514,16515,16516,16517,16518,16519,16522,16523,16549,16795,16796,16797,16798,16799,16800,16801,16802,16803,17777,17778,17779,17780,17781,17782,17783,17784,17785,180,184,3578,3579,3580,3581,3582,4299,50176,50177,50178,50213,50217,50298,50299,50300,50301,50302,7423,7424,7425,7426,7427,7428,7429,7449,7450,787,788,791,792,794,796,797,798,800,801,8872,8873,8874,8877,8878,8879,8880,8881,9014,9432],RDM:[10025,16524,16525,16526,16527,16528,16529,16530,17786,17787,17788,50195,50200,50201,50216,50303,50304,50305,50306,7503,7504,7505,7506,7507,7509,7510,7511,7512,7513,7514,7515,7516,7517,7518,7519,7520,7521,7523,7524,7525,7526,7527,7528,7529,7530,8882,8883,8884,8885,8887,8888,8889,8890,8891,8892,9433,9434],BLU:[11715,11383,11384,11385,11386,11387,11388,11389,11390,11391,11392,11393,11394,11395,11396,11397,11398,11399,11400,11401,11402,11403,11404,11405,11406,11407,11408,11409,11410,11411,11412,11413,11414,11415,11416,11417,11418,11419,11420,11421,11422,11423,11424,11425,11426,11427,11428,11429,11430,11431,50219,50220,50221,50222,50223,50224]},L.abilityMatchRegex=/[a-fA-F0-9]{1,4}/i;class k{constructor(t,e,a,i,s,n,r,l,o){this.posX=t,this.posY=e,this.posZ=a,this.heading=i,this.targetable=s,this.HP=n,this.maxHP=r,this.MP=l,this.maxMP=o}partialClone(t){return new k(Number(t.posX)||this.posX,Number(t.posY)||this.posY,Number(t.posZ)||this.posZ,Number(t.heading)||this.heading,t.targetable||this.targetable,Number(t.HP)||this.HP,Number(t.maxHP)||this.maxHP,Number(t.MP)||this.MP,Number(t.maxMP)||this.maxMP)}toPluginState(){return{PosX:this.posX,PosY:this.posY,PosZ:this.posZ,Heading:this.heading,CurrentHP:this.HP,MaxHP:this.maxHP,CurrentMP:this.MP,MaxMP:this.maxMP}}}const H={cn:["绿宝石兽","黄宝石兽","伊弗利特之灵","泰坦之灵","迦楼罗之灵","朝日小仙女","夕月小仙女","车式浮空炮塔","象式浮空炮塔","亚灵神巴哈姆特","亚灵神不死鸟","炽天使","月长宝石兽","英雄的掠影","后式自走人偶","分身"],de:["Smaragd-Karfunkel","Topas-Karfunkel","Ifrit-Egi","Titan-Egi","Garuda-Egi","Eos","Selene","Selbstschuss-Gyrocopter TURM","Selbstschuss-Gyrocopter LÄUFER","Demi-Bahamut","Demi-Phönix","Seraph","Mondstein-Karfunkel","Schattenschemen","Automaton DAME","Gedoppeltes Ich"],en:["Emerald Carbuncle","Topaz Carbuncle","Ifrit-Egi","Titan-Egi","Garuda-Egi","Eos","Selene","Rook Autoturret","Bishop Autoturret","Demi-Bahamut","Demi-Phoenix","Seraph","Moonstone Carbuncle","Esteem","Automaton Queen","Bunshin"],fr:["Carbuncle émeraude","Carbuncle topaze","Ifrit-Egi","Titan-Egi","Garuda-Egi","Eos","Selene","Auto-tourelle Tour","Auto-tourelle Fou","Demi-Bahamut","Demi-Phénix","Séraphin","Carbuncle hécatolite","Estime","Automate Reine","Ombre"],ja:["カーバンクル・エメラルド","カーバンクル・トパーズ","イフリート・エギ","タイタン・エギ","ガルーダ・エギ","フェアリー・エオス","フェアリー・セレネ","オートタレット・ルーク","オートタレット・ビショップ","デミ・バハムート","デミ・フェニックス","セラフィム","カーバンクル・ムーンストーン","英雄の影身","オートマトン・クイーン","分身"],ko:["카벙클 에메랄드","카벙클 토파즈","이프리트 에기","타이탄 에기","가루다 에기","요정 에오스","요정 셀레네","자동포탑 룩","자동포탑 비숍","데미바하무트","데미피닉스","세라핌","카벙클 문스톤","영웅의 환영","자동인형 퀸","분신"]};class j{constructor(t,e){this.language=e,this.firstTimestamp=Number.MAX_SAFE_INTEGER,this.lastTimestamp=0,this.combatants={},this.partyMembers=[],this.enemies=[],this.others=[],this.pets=[],this.mainCombatantID=null,this.initialStates={},this.initialize(t),delete this.initialStates}initialize(t){for(let e=0;e<t.length;++e){const a=t[e];switch(this.firstTimestamp=Math.min(this.firstTimestamp,a.timestamp),this.lastTimestamp=Math.max(this.lastTimestamp,a.timestamp),a.hexEvent){case"14":case"15":case"16":case"19":case"1A":case"1B":case"1E":case"22":case"23":this.addCombatantFromLine(a),this.addCombatantFromTargetLine(a);break;case"00":break;default:this.addCombatantFromLine(a)}}for(const t in this.initialStates){const e=this.initialStates[t];this.combatants[t].pushState(this.firstTimestamp,new k(Number(e.posX),Number(e.posY),Number(e.posZ),Number(e.heading),e.targetable,Number(e.HP),Number(e.maxHP),Number(e.MP),Number(e.maxMP)))}const e={};for(let a=0;a<t.length;++a){const i=t[a];let s=this.extractStateFromLine(i);s&&(e[i.id]=e[i.id]||0,++e[i.id],this.combatants[i.id].pushPartialState(i.timestamp,s)),s=this.extractStateFromTargetLine(i),s&&(e[i.targetId]=e[i.targetId]||0,++e[i.targetId],this.combatants[i.targetId].pushPartialState(i.timestamp,s))}const a=H[this.language];this.others=this.others.filter((t=>null!==this.combatants[t].job&&"NONE"!==this.combatants[t].job&&t.startsWith("1")?(this.partyMembers.push(t),!1):a.includes(this.combatants[t].name)?(this.pets.push(t),!1):!(e[t]>0&&(this.enemies.push(t),1)))),this.mainCombatantID=this.enemies.sort(((t,a)=>e[a]-e[t]))[0]||null}addCombatantFromLine(t){if(!t.id)return;this.initCombatant(t.id,t.name,t.timestamp);const e=this.initialStates[t.id],a=this.extractStateFromLine(t);e.timestamp=Math.min(e.timestamp,t.timestamp),e.posX=e.posX||a.posX||null,e.posY=e.posY||a.posY||null,e.posZ=e.posZ||a.posZ||null,e.heading=e.heading||a.heading||null,e.targetable=e.targetable||a.targetable||!1,e.HP=e.HP||a.HP||null,e.maxHP=e.maxHP||a.maxHP||null,e.MP=e.MP||a.MP||null,e.maxMP=e.maxMP||a.maxMP||null,this.combatants[t.id].job=this.combatants[t.id].job||a.job||null,this.combatants[t.id].level=this.combatants[t.id].level||a.level||null,!t.abilityId||this.combatants[t.id].job||t.id.startsWith("4")||(this.combatants[t.id].job=L.getJob(t.abilityId)),this.combatants[t.id].job&&(this.combatants[t.id].job=this.combatants[t.id].job.toUpperCase())}addCombatantFromTargetLine(t){if(!t.targetId)return;this.initCombatant(t.targetId,t.targetName,t.timestamp);const e=this.initialStates[t.targetId],a=this.extractStateFromTargetLine(t);e.posX=e.posX||a.posX||null,e.posY=e.posY||a.posY||null,e.posZ=e.posZ||a.posZ||null,e.heading=e.heading||a.heading||null,e.HP=e.HP||a.HP||null,e.maxHP=e.maxHP||a.maxHP||null,e.MP=e.MP||a.MP||null,e.maxMP=e.maxMP||a.maxMP||null}extractStateFromLine(t){if(!t.id)return!1;const e={};return void 0!==t.x&&(e.posX=t.x),void 0!==t.y&&(e.posY=t.y),void 0!==t.z&&(e.posZ=t.z),void 0!==t.heading&&(e.heading=t.heading),void 0!==t.targetable&&(e.targetable=t.targetable),void 0!==t.hp&&(e.HP=t.hp),void 0!==t.maxHp&&(e.maxHP=t.maxHp),void 0!==t.mp&&(e.MP=t.mp),void 0!==t.maxMp&&(e.maxMP=t.maxMp),void 0!==t.jobName&&(e.job=t.jobName),void 0!==t.level&&(e.level=t.level),e}extractStateFromTargetLine(t){if(!t.targetId)return!1;const e={};return void 0!==t.targetX&&(e.posX=t.targetX),void 0!==t.targetY&&(e.posY=t.targetY),void 0!==t.targetZ&&(e.posZ=t.targetZ),void 0!==t.targetHeading&&(e.heading=t.targetHeading),void 0!==t.targetHp&&(e.HP=t.targetHp),void 0!==t.targetMaxHp&&(e.maxHP=t.targetMaxHp),void 0!==t.targetMp&&(e.MP=t.targetMp),void 0!==t.targetMaxMp&&(e.maxMP=t.targetMaxMp),e}initCombatant(t,e,a){void 0===this.combatants[t]?(this.combatants[t]=new T(t,e),this.others.push(t),this.initialStates[t]={timestamp:a,posX:null,posY:null,posZ:null,heading:null,targetable:!0,HP:null,maxHP:null,MP:null,maxMP:null}):""===this.combatants[t].name&&(this.combatants[t].name=e)}getMainCombatantName(){return this.mainCombatantID?this.combatants[this.mainCombatantID].name:"Unknown"}}class R{constructor(){this.listeners={}}on(t,e,a){var i,s,n;const r=t.split(" "),l=[];a=null!=a?a:"undefined"==typeof window?{}:window;for(const t of r){const r=null!==(i=(n=this.listeners)[t])&&void 0!==i?i:n[t]=[];void 0!==e&&r.push({event:t,scope:a,callback:e}),l.push(...null!==(s=this.listeners[t])&&void 0!==s?s:[])}return l}async dispatch(t,...e){var a;if(void 0!==this.listeners[t])for(const i of null!==(a=this.listeners[t])&&void 0!==a?a:[]){const t=i.callback.apply(i.scope,e);await Promise.resolve(t)}}}class A{constructor(t,e,a){var i,s,n;this.networkLine=e,this.offset=0,this.invalid=!1,this.index=0,this.decEvent=parseInt(null!==(i=a[0])&&void 0!==i?i:"0"),this.hexEvent=F.zeroPad(this.decEvent.toString(16).toUpperCase()),this.timestamp=new Date(null!==(s=a[1])&&void 0!==s?s:"0").getTime(),this.checksum=null!==(n=a.slice(-1)[0])&&void 0!==n?n:"",t.updateTimestamp(this.timestamp),this.convertedLine=this.prefix()+a.join(":").replace("|",":")}prefix(){return"["+F.timeToTimeString(this.timestamp,!0)+"] "+this.hexEvent+":"}static isDamageHallowed(t){return(parseInt(t,16)&parseInt("1000",16))>0}static isDamageBig(t){return(parseInt(t,16)&parseInt("4000",16))>0}static calculateDamage(t){if(A.isDamageHallowed(t))return 0;const e=[(t=F.zeroPad(t,8)).substr(0,2),t.substr(2,2),t.substr(4,2),t.substr(6,2)];return A.isDamageBig(t)?parseInt(e[3]+e[0]+(parseInt(e[1],16)-parseInt(e[3],16)).toString(16),16):parseInt(e.slice(0,2).reverse().join(""),16)}}class U extends A{constructor(t,e,a){var i,s;super(t,e,a),this.zoneId=null!==(i=a[2])&&void 0!==i?i:"",this.zoneName=null!==(s=a[3])&&void 0!==s?s:"",this.zoneNameProperCase=F.properCase(this.zoneName),this.convertedLine=this.prefix()+"Changed Zone to "+this.zoneName+".",this.properCaseConvertedLine=this.prefix()+"Changed Zone to "+this.zoneNameProperCase+"."}}class D extends U{}class z extends R{constructor(){super(...arguments),this.currentFight=[],this.currentZoneName="Unknown",this.currentZoneId="-1"}parseLogs(t){for(const e of t)this.currentFight.push(e),e.offset=e.timestamp-this.currentFightStart,F.matchEnd(e.networkLine)?this.endFight():e instanceof U&&(this.currentZoneId=e.zoneId,this.currentZoneName=e.zoneName,this.endFight())}get currentFightStart(){var t,e;return null!==(e=null===(t=this.currentFight[0])||void 0===t?void 0:t.timestamp)&&void 0!==e?e:0}get currentFightEnd(){var t,e;return null!==(e=null===(t=this.currentFight.slice(-1)[0])||void 0===t?void 0:t.timestamp)&&void 0!==e?e:0}endFight(){if(this.currentFight.length<2)return;const t=new Date(this.currentFightStart).toISOString(),e=new Date(this.currentFightEnd).toISOString();console.debug(`Dispatching new fight\nStart: ${t}\nEnd: ${e}\nZone: ${this.currentZoneName}\nLine Count: ${this.currentFight.length}\n`),this.dispatch("fight",t.substr(0,10),this.currentZoneId,this.currentZoneName,this.currentFight),this.currentFight=[]}}const B=(t,e)=>{if(e)return H[e].includes(t);for(const e in H)if(H[e].includes(t))return!0;return!1};class O{constructor(t,e,a,i){this.id=null,this.encounterZoneId=e,this.encounterZoneName=a,this.encounterDay=t,this.logLines=i,this.initialize()}initialize(){this.initialOffset=Number.MAX_SAFE_INTEGER,this.endStatus="Unknown",this.startStatus=new Set,this.engageAt=Number.MAX_SAFE_INTEGER,this.firstPlayerAbility=Number.MAX_SAFE_INTEGER,this.firstEnemyAbility=Number.MAX_SAFE_INTEGER,this.firstLineIndex=0;for(let t=0;t<this.logLines.length;++t){const e=this.logLines[t];let a=F.matchStart(e.networkLine);if(a){this.firstLineIndex=t,this.startStatus.add(a.groups.StartType);const i=parseInt(a.groups.StartIn);i>=0&&(this.engageAt=Math.min(e.timestamp+i,this.engageAt))}else a=F.matchEnd(e.networkLine),a?this.endStatus=a.groups.EndType:e.id&&e.targetId&&(e.id.startsWith("1")||e.id.startsWith("4")&&B(e.name,this.language)?e.targetId.startsWith("4")&&!B(e.targetName,this.language)&&(this.firstPlayerAbility=Math.min(this.firstPlayerAbility,e.timestamp)):e.id.startsWith("4")&&!B(e.name,this.language)&&(e.targetId.startsWith("1")||B(e.targetName,this.language))&&(this.firstEnemyAbility=Math.min(this.firstEnemyAbility,e.timestamp)));a&&a.groups&&a.groups.language&&(this.language=a.groups.language||this.language)}this.language=this.language||"en",this.firstPlayerAbility===Number.MAX_SAFE_INTEGER&&(this.firstPlayerAbility=null),this.firstEnemyAbility===Number.MAX_SAFE_INTEGER&&(this.firstEnemyAbility=null),this.engageAt===Number.MAX_SAFE_INTEGER&&(this.engageAt=null),this.combatantTracker=new j(this.logLines,this.language),this.startTimestamp=this.combatantTracker.firstTimestamp,this.endTimestamp=this.combatantTracker.lastTimestamp,this.duration=this.endTimestamp-this.startTimestamp,this.initialOffset===Number.MAX_SAFE_INTEGER&&(null!==this.engageAt?this.initialOffset=this.engageAt-this.startTimestamp:null!==this.firstPlayerAbility?this.initialOffset=this.firstPlayerAbility-this.startTimestamp:null!==this.firstEnemyAbility?this.initialOffset=this.firstEnemyAbility-this.startTimestamp:this.initialOffset=0),this.playbackOffset=this.logLines[this.firstLineIndex].offset,this.startStatus=[...this.startStatus].sort().join(", ")}shouldPersistFight(){return this.firstPlayerAbility>0&&this.firstEnemyAbility>0}}class Z{constructor(){this.Combatants={},this.firstTimestamp=Number.MAX_SAFE_INTEGER}updateTimestamp(t){this.firstTimestamp=Math.min(this.firstTimestamp,t)}updateCombatant(t,e){if((t=t.toUpperCase())&&t.length){let a=this.Combatants[t];void 0===a?(a={name:e.name,job:e.job,spawn:e.spawn,despawn:e.despawn},this.Combatants[t]=a):(a.name=e.name||a.name,a.job=e.job||a.job,a.spawn=Math.min(a.spawn,e.spawn),a.despawn=Math.max(a.despawn,e.despawn))}}resolveName(t,e,a=null,i=null){var s,n;let r=e;return null!==a&&"E0000000"===t&&""===r&&(r=a.startsWith("4")?null!=i?i:"":"Unknown"),""===r&&(r=null!==(n=null===(s=this.Combatants[t])||void 0===s?void 0:s.name)&&void 0!==n?n:""),r}}class G extends A{constructor(t,e,a){var i,s;super(t,e,a),this.type=null!==(i=a[2])&&void 0!==i?i:"",this.speaker=null!==(s=a[3])&&void 0!==s?s:"",this.message=a.slice(4,-1).join("|"),this.message.split("").length>1&&(this.invalid=!0),this.convertedLine=this.prefix()+this.type+":"+(""!==this.speaker?this.speaker+":":"")+this.message.trim(),this.convertedLine=$.replaceChatSymbols(this.convertedLine)}static replaceChatSymbols(t){for(const e of $.chatSymbolReplacements)t=t.replace(e.Search,e.Replace);return t}}G.chatSymbolReplacements=[{Search:/:\uE06F/g,Replace:":⇒",Type:"Symbol"},{Search:/ \uE0BB\uE05C/g,Replace:" ",Type:"Positive Effect"},{Search:/ \uE0BB\uE05B/g,Replace:" ",Type:"Negative Effect"}];class $ extends G{}class X extends A{constructor(t,e,a){var i,s,n;super(t,e,a),this.id=null!==(s=null===(i=a[2])||void 0===i?void 0:i.toUpperCase())&&void 0!==s?s:"",this.name=null!==(n=a[3])&&void 0!==n?n:"",this.convertedLine=this.prefix()+"Changed primary player to "+this.name+"."}}class Y extends X{}const _={NONE:0,GLA:1,PGL:2,MRD:3,LNC:4,ARC:5,CNJ:6,THM:7,CRP:8,BSM:9,ARM:10,GSM:11,LTW:12,WVR:13,ALC:14,CUL:15,MIN:16,BTN:17,FSH:18,PLD:19,MNK:20,WAR:21,DRG:22,BRD:23,WHM:24,BLM:25,ACN:26,SMN:27,SCH:28,ROG:29,NIN:30,MCH:31,DRK:32,AST:33,SAM:34,RDM:35,BLU:36,GNB:37,DNC:38},W=Object.keys(_),J=["GLA","PLD","MRD","WAR","DRK","GNB"],K=["CNJ","WHM","SCH","AST"],V=["PGL","MNK","LNC","DRG","ROG","NIN","SAM"],q=["ARC","BRD","DNC","MCH"],Q=["BLU","RDM","BLM","SMN","ACN","THM"],tt=[...V,...q,...Q],et=["CRP","BSM","ARM","GSM","LTW","WVR","ALC","CUL"],at=["MIN","BTN","FSH"],it=((()=>{const t=(t,e,a)=>{e.forEach((e=>t.set(e,a)))},e=new Map([["NONE","none"]]);t(e,J,"tank"),t(e,K,"healer"),t(e,tt,"dps"),t(e,et,"crafter"),t(e,at,"gatherer")})(),t=>{const e=W.find((e=>_[e]===t));return null!=e?e:"NONE"});class st extends A{constructor(t,e,a){var i,s,n,r,l,o,d,u,p,m,c,h,g,f,y,v,b,C,x,I,S,N;super(t,e,a),this.id=null!==(s=null===(i=a[2])||void 0===i?void 0:i.toUpperCase())&&void 0!==s?s:"",this.name=null!==(n=a[3])&&void 0!==n?n:"",this.jobIdHex=null!==(l=null===(r=a[4])||void 0===r?void 0:r.toUpperCase())&&void 0!==l?l:"",this.jobIdDec=parseInt(this.jobIdHex,16),this.jobName=it(this.jobIdDec),this.levelString=null!==(o=a[5])&&void 0!==o?o:"",this.level=parseFloat(this.levelString),this.ownerId=null!==(u=null===(d=a[6])||void 0===d?void 0:d.toUpperCase())&&void 0!==u?u:"",this.worldId=null!==(p=a[7])&&void 0!==p?p:"",this.worldName=null!==(m=a[8])&&void 0!==m?m:"",this.npcNameId=null!==(c=a[9])&&void 0!==c?c:"",this.npcBaseId=null!==(h=a[10])&&void 0!==h?h:"",this.currentHp=parseFloat(null!==(g=a[11])&&void 0!==g?g:""),this.maxHpString=null!==(f=a[14])&&void 0!==f?f:"",this.maxHp=parseFloat(this.maxHpString),this.currentMp=parseFloat(null!==(y=a[13])&&void 0!==y?y:""),this.maxMpString=null!==(v=a[14])&&void 0!==v?v:"",this.maxMp=parseFloat(this.maxMpString),this.currentTp=parseFloat(null!==(b=a[15])&&void 0!==b?b:""),this.maxTp=parseFloat(null!==(C=a[16])&&void 0!==C?C:""),this.xString=null!==(x=a[17])&&void 0!==x?x:"",this.x=parseFloat(this.xString),this.yString=null!==(I=a[18])&&void 0!==I?I:"",this.y=parseFloat(this.yString),this.zString=null!==(S=a[19])&&void 0!==S?S:"",this.z=parseFloat(this.zString),this.heading=parseFloat(null!==(N=a[20])&&void 0!==N?N:""),t.updateCombatant(this.id,{name:this.name,spawn:this.timestamp,despawn:this.timestamp,job:this.jobIdHex});let M=this.name;""!==this.worldName&&(M=M+"("+this.worldName+")"),this.convertedLine=this.prefix()+this.id.toUpperCase()+":Added new combatant "+M+".  Job: "+this.jobName+" Level: "+this.levelString+" Max HP: "+this.maxHpString+" Max MP: "+this.maxMpString+" Pos: ("+this.xString+","+this.yString+","+this.zString+")";const P=this.npcNameId+F.zeroPad(this.npcBaseId,8+Math.max(0,6-this.npcNameId.length));"00000000000000"!==P&&(this.convertedLine+=" ("+P+")"),this.convertedLine+="."}}class nt extends st{}class rt extends st{constructor(t,e,a){super(t,e,a),this.convertedLine=this.prefix()+this.id.toUpperCase()+":Removing combatant "+this.name+". Max MP: "+this.maxMpString+". Pos: ("+this.xString+","+this.yString+","+this.zString+")"}}class lt extends rt{}class ot extends A{constructor(t,e,a){var i,s,n,r,l,o,d,u,p,m,c,h,g,f,y,v;super(t,e,a),this.class=null!==(i=a[2])&&void 0!==i?i:"",this.strength=null!==(s=a[3])&&void 0!==s?s:"",this.dexterity=null!==(n=a[4])&&void 0!==n?n:"",this.vitality=null!==(r=a[5])&&void 0!==r?r:"",this.intelligence=null!==(l=a[6])&&void 0!==l?l:"",this.mind=null!==(o=a[7])&&void 0!==o?o:"",this.piety=null!==(d=a[8])&&void 0!==d?d:"",this.attackPower=null!==(u=a[9])&&void 0!==u?u:"",this.directHit=null!==(p=a[10])&&void 0!==p?p:"",this.criticalHit=null!==(m=a[11])&&void 0!==m?m:"",this.attackMagicPotency=null!==(c=a[12])&&void 0!==c?c:"",this.healMagicPotency=null!==(h=a[13])&&void 0!==h?h:"",this.determination=null!==(g=a[14])&&void 0!==g?g:"",this.skillSpeed=null!==(f=a[15])&&void 0!==f?f:"",this.spellSpeed=null!==(y=a[16])&&void 0!==y?y:"",this.tenacity=null!==(v=a[18])&&void 0!==v?v:"",this.convertedLine=this.prefix()+"Player Stats: "+a.slice(2,a.length-1).join(":").replace(/\|/g,":")}}class dt extends ot{}class ut extends A{constructor(t,e,a){var i,s,n,r,l,o,d,u,p,m;super(t,e,a),this.id=null!==(s=null===(i=a[2])||void 0===i?void 0:i.toUpperCase())&&void 0!==s?s:"",this.name=null!==(n=a[3])&&void 0!==n?n:"",this.abilityId=null!==(l=null===(r=a[4])||void 0===r?void 0:r.toUpperCase())&&void 0!==l?l:"",this.abilityName=null!==(o=a[5])&&void 0!==o?o:"",this.targetId=null!==(u=null===(d=a[6])||void 0===d?void 0:d.toUpperCase())&&void 0!==u?u:"",this.targetName=null!==(p=a[7])&&void 0!==p?p:"",this.duration=null!==(m=a[8])&&void 0!==m?m:"",t.updateCombatant(this.id,{job:void 0,name:this.name,spawn:this.timestamp,despawn:this.timestamp}),t.updateCombatant(this.targetId,{job:void 0,name:this.targetName,spawn:this.timestamp,despawn:this.timestamp});const c=0===this.targetName.length?"Unknown":this.targetName;this.convertedLine=this.prefix()+this.abilityId+":"+this.name+" starts using "+this.abilityName+" on "+c+".",this.properCaseConvertedLine=this.prefix()+this.abilityId+":"+F.properCase(this.name)+" starts using "+this.abilityName+" on "+F.properCase(c)+"."}}class pt extends ut{}class mt extends A{constructor(t,e,a){var i,s,n,r,l,o,d,u,p,m,c,h,g,f,y,v,b,C,x,I,S,N,M,P,w,E,F;super(t,e,a),this.id=null!==(s=null===(i=a[2])||void 0===i?void 0:i.toUpperCase())&&void 0!==s?s:"",this.name=null!==(n=a[3])&&void 0!==n?n:"",this.flags=null!==(r=a[8])&&void 0!==r?r:"";const T="3F"===this.flags?2:0;this.damage=A.calculateDamage(null!==(l=a[9+T])&&void 0!==l?l:""),this.abilityId=null!==(d=null===(o=a[4])||void 0===o?void 0:o.toUpperCase())&&void 0!==d?d:"",this.abilityName=null!==(u=a[5])&&void 0!==u?u:"",this.targetId=null!==(m=null===(p=a[6])||void 0===p?void 0:p.toUpperCase())&&void 0!==m?m:"",this.targetName=null!==(c=a[7])&&void 0!==c?c:"",this.targetHp=null!==(h=a[24+T])&&void 0!==h?h:"",this.targetMaxHp=null!==(g=a[25+T])&&void 0!==g?g:"",this.targetMp=null!==(f=a[26+T])&&void 0!==f?f:"",this.targetMaxMp=null!==(y=a[27+T])&&void 0!==y?y:"",this.targetX=null!==(v=a[30+T])&&void 0!==v?v:"",this.targetY=null!==(b=a[31+T])&&void 0!==b?b:"",this.targetZ=null!==(C=a[32+T])&&void 0!==C?C:"",this.targetHeading=null!==(x=a[33+T])&&void 0!==x?x:"",this.sourceHp=null!==(I=a[34+T])&&void 0!==I?I:"",this.sourceMaxHp=null!==(S=a[35+T])&&void 0!==S?S:"",this.sourceMp=null!==(N=a[36+T])&&void 0!==N?N:"",this.sourceMaxMp=null!==(M=a[37+T])&&void 0!==M?M:"",this.x=null!==(P=a[40+T])&&void 0!==P?P:"",this.y=null!==(w=a[41+T])&&void 0!==w?w:"",this.z=null!==(E=a[42+T])&&void 0!==E?E:"",this.heading=null!==(F=a[43+T])&&void 0!==F?F:"",t.updateCombatant(this.id,{job:void 0,name:this.name,spawn:this.timestamp,despawn:this.timestamp}),t.updateCombatant(this.targetId,{job:void 0,name:this.targetName,spawn:this.timestamp,despawn:this.timestamp})}}class ct extends mt{}class ht extends mt{constructor(t,e,a){super(t,e,a)}}class gt extends ht{}class ft extends A{constructor(t,e,a){var i,s,n,r,l,o,d;super(t,e,a),this.id=null!==(s=null===(i=a[2])||void 0===i?void 0:i.toUpperCase())&&void 0!==s?s:"",this.name=null!==(n=a[3])&&void 0!==n?n:"",this.abilityId=null!==(l=null===(r=a[4])||void 0===r?void 0:r.toUpperCase())&&void 0!==l?l:"",this.abilityName=null!==(o=a[5])&&void 0!==o?o:"",this.reason=null!==(d=a[6])&&void 0!==d?d:""}}class yt extends ft{}class vt extends A{constructor(t,e,a){var i,s,n,r,l,o,d,u,p,m,c,h,g,f,y,v,b,C;super(t,e,a),this.id=null!==(s=null===(i=a[2])||void 0===i?void 0:i.toUpperCase())&&void 0!==s?s:"",this.name=null!==(n=a[3])&&void 0!==n?n:"",this.type=null!==(r=a[4])&&void 0!==r?r:"",this.effectId=null!==(o=null===(l=a[5])||void 0===l?void 0:l.toUpperCase())&&void 0!==o?o:"",this.damage=parseInt(null!==(d=a[6])&&void 0!==d?d:"",16),this.currentHp=parseInt(null!==(u=a[7])&&void 0!==u?u:""),this.maxHp=parseInt(null!==(p=a[8])&&void 0!==p?p:""),this.currentMp=parseInt(null!==(m=a[9])&&void 0!==m?m:""),this.maxMp=parseInt(null!==(c=a[10])&&void 0!==c?c:""),this.currentTp=parseInt(null!==(h=a[11])&&void 0!==h?h:""),this.maxTp=parseInt(null!==(g=a[12])&&void 0!==g?g:""),this.x=parseFloat(null!==(f=a[13])&&void 0!==f?f:""),this.y=parseFloat(null!==(y=a[14])&&void 0!==y?y:""),this.z=parseFloat(null!==(v=a[15])&&void 0!==v?v:""),this.heading=parseFloat(null!==(b=a[16])&&void 0!==b?b:""),t.updateCombatant(this.id,{job:void 0,name:this.name,spawn:this.timestamp,despawn:this.timestamp});let x="";const I=t.resolveName(this.id,this.name);this.effectId in vt.showEffectNamesFor&&(x=null!==(C=vt.showEffectNamesFor[this.effectId])&&void 0!==C?C:"");let S="";x&&(S=x+" "),this.convertedLine=this.prefix()+S+this.type+" Tick on "+I+" for "+this.damage.toString()+" damage.",this.properCaseConvertedLine=this.prefix()+S+this.type+" Tick on "+F.properCase(I)+" for "+this.damage.toString()+" damage."}}vt.showEffectNamesFor={"4C4":"Excognition","35D":"Wildfire","1F5":"Doton","2ED":"Salted Earth","4B5":"Flamethrower","2E3":"Asylum",777:"Asylum",798:"Sacred Soil","4C7":"Fey Union",742:"Nascent Glint"};class bt extends vt{}class Ct extends A{constructor(t,e,a){var i,s,n,r,l,o;let d,u;super(t,e,a),this.id=null!==(s=null===(i=a[2])||void 0===i?void 0:i.toUpperCase())&&void 0!==s?s:"",this.name=null!==(n=a[3])&&void 0!==n?n:"",this.targetId=null!==(l=null===(r=a[4])||void 0===r?void 0:r.toUpperCase())&&void 0!==l?l:"",this.targetName=null!==(o=a[5])&&void 0!==o?o:"",t.updateCombatant(this.id,{job:void 0,name:this.name,spawn:this.timestamp,despawn:this.timestamp}),t.updateCombatant(this.targetId,{job:void 0,name:this.targetName,spawn:this.timestamp,despawn:this.timestamp}),"00"!==this.id&&(d=t.resolveName(this.id,this.name)),"00"!==this.targetId&&(u=t.resolveName(this.targetId,this.targetName));const p=null!=d?d:this.name,m=null!=u?u:this.targetName;this.convertedLine=this.prefix()+p+" was defeated by "+m+".",this.properCaseConvertedLine=this.prefix()+F.properCase(p)+" was defeated by "+F.properCase(m)+"."}}class xt extends Ct{}class It extends A{constructor(t,e,a){var i,s,n,r,l,o,d,u,p,m,c,h,g;super(t,e,a),this.abilityId=null!==(s=null===(i=a[2])||void 0===i?void 0:i.toUpperCase())&&void 0!==s?s:"",this.abilityName=null!==(n=a[3])&&void 0!==n?n:"",this.durationString=null!==(r=a[4])&&void 0!==r?r:"",this.durationFloat=parseFloat(this.durationString),this.id=null!==(o=null===(l=a[5])||void 0===l?void 0:l.toUpperCase())&&void 0!==o?o:"",this.name=null!==(d=a[6])&&void 0!==d?d:"",this.targetId=null!==(p=null===(u=a[7])||void 0===u?void 0:u.toUpperCase())&&void 0!==p?p:"",this.targetName=null!==(m=a[8])&&void 0!==m?m:"",this.stacks=parseInt(null!==(c=a[9])&&void 0!==c?c:"0"),this.targetHp=null!==(h=a[10])&&void 0!==h?h:"",this.sourceHp=null!==(g=a[11])&&void 0!==g?g:"",t.updateCombatant(this.id,{name:this.name,spawn:this.timestamp,despawn:this.timestamp,job:void 0}),t.updateCombatant(this.targetId,{name:this.targetName,spawn:this.timestamp,despawn:this.timestamp,job:void 0}),this.resolvedName=t.resolveName(this.id,this.name),this.resolvedTargetName=t.resolveName(this.targetId,this.targetName),this.fallbackResolvedTargetName=t.resolveName(this.id,this.name,this.targetId,this.targetName);let f="";this.stacks>0&&this.stacks<20&&It.showStackCountFor.includes(this.abilityId)&&(f=" ("+this.stacks.toString()+")"),this.convertedLine=this.prefix()+this.targetId+":"+this.targetName+" gains the effect of "+this.abilityName+" from "+this.fallbackResolvedTargetName+" for "+this.durationString+" Seconds."+f,this.properCaseConvertedLine=this.prefix()+this.targetId+":"+F.properCase(this.targetName)+" gains the effect of "+this.abilityName+" from "+F.properCase(this.fallbackResolvedTargetName)+" for "+this.durationString+" Seconds."+f}}It.showStackCountFor=["130","196","15e","2ca","1f9","4d7","511"];class St extends It{}class Nt extends A{constructor(t,e,a){var i,s,n,r;super(t,e,a),this.targetId=null!==(s=null===(i=a[2])||void 0===i?void 0:i.toUpperCase())&&void 0!==s?s:"",this.targetName=null!==(n=a[3])&&void 0!==n?n:"",this.headmarkerId=null!==(r=a[6])&&void 0!==r?r:""}}class Mt extends Nt{}class Pt extends A{constructor(t,e,a){var i,s,n,r,l,o,d,u;super(t,e,a),this.operation=null!==(i=a[2])&&void 0!==i?i:"",this.waymark=null!==(s=a[3])&&void 0!==s?s:"",this.id=null!==(r=null===(n=a[4])||void 0===n?void 0:n.toUpperCase())&&void 0!==r?r:"",this.name=null!==(l=a[5])&&void 0!==l?l:"",this.x=null!==(o=a[6])&&void 0!==o?o:"",this.y=null!==(d=a[7])&&void 0!==d?d:"",this.z=null!==(u=a[8])&&void 0!==u?u:""}}class wt extends Pt{}class Et extends A{constructor(t,e,a){var i,s,n,r,l,o,d,u;super(t,e,a),this.operation=null!==(i=a[2])&&void 0!==i?i:"",this.waymark=null!==(s=a[3])&&void 0!==s?s:"",this.id=null!==(r=null===(n=a[4])||void 0===n?void 0:n.toUpperCase())&&void 0!==r?r:"",this.name=null!==(l=a[5])&&void 0!==l?l:"",this.targetId=null!==(d=null===(o=a[6])||void 0===o?void 0:o.toUpperCase())&&void 0!==d?d:"",this.targetName=null!==(u=a[7])&&void 0!==u?u:""}}class Ft extends Et{}class Tt extends It{constructor(t,e,a){super(t,e,a);let i="";this.stacks>0&&this.stacks<20&&It.showStackCountFor.includes(this.abilityId)&&(i=" ("+this.stacks.toString()+")"),this.convertedLine=this.prefix()+this.targetId+":"+this.targetName+" loses the effect of "+this.abilityName+" from "+this.fallbackResolvedTargetName+" for "+this.durationString+" Seconds."+i,this.properCaseConvertedLine=this.prefix()+this.targetId+":"+F.properCase(this.targetName)+" loses the effect of "+this.abilityName+" from "+F.properCase(this.fallbackResolvedTargetName)+" for "+this.durationString+" Seconds."+i}}class Lt extends Tt{}const kt=t=>[t.substr(6,2),t.substr(4,2),t.substr(2,2),t.substr(0,2)];class Ht extends A{constructor(t,e,a){var i,s,n,r,l,o,d,u,p;super(t,e,a),this.id=null!==(s=null===(i=a[2])||void 0===i?void 0:i.toUpperCase())&&void 0!==s?s:"",this.dataBytes1=F.zeroPad(null!==(n=a[3])&&void 0!==n?n:""),this.dataBytes2=F.zeroPad(null!==(r=a[4])&&void 0!==r?r:""),this.dataBytes3=F.zeroPad(null!==(l=a[5])&&void 0!==l?l:""),this.dataBytes4=F.zeroPad(null!==(o=a[6])&&void 0!==o?o:""),this.jobGaugeBytes=[...kt(this.dataBytes1),...kt(this.dataBytes2),...kt(this.dataBytes3),...kt(this.dataBytes4)],this.name=(null===(d=t.Combatants[this.id])||void 0===d?void 0:d.name)||"",t.updateCombatant(this.id,{name:null===(u=t.Combatants[this.id])||void 0===u?void 0:u.name,spawn:this.timestamp,despawn:this.timestamp,job:null===(p=this.jobGaugeBytes[0])||void 0===p?void 0:p.toUpperCase()}),this.convertedLine=this.prefix()+this.id+":"+this.name+":"+this.dataBytes1+":"+this.dataBytes2+":"+this.dataBytes3+":"+this.dataBytes4,this.properCaseConvertedLine=this.prefix()+this.id+":"+F.properCase(this.name)+":"+this.dataBytes1+":"+this.dataBytes2+":"+this.dataBytes3+":"+this.dataBytes4}}class jt extends Ht{}class Rt extends A{constructor(t,e,a){var i,s,n,r,l,o,d;super(t,e,a),this.id=null!==(s=null===(i=a[2])||void 0===i?void 0:i.toUpperCase())&&void 0!==s?s:"",this.name=null!==(n=a[3])&&void 0!==n?n:"",this.targetId=null!==(l=null===(r=a[4])||void 0===r?void 0:r.toUpperCase())&&void 0!==l?l:"",this.targetName=null!==(o=a[5])&&void 0!==o?o:"",this.targetable=!!parseInt(null!==(d=a[6])&&void 0!==d?d:"",16)}}class At extends Rt{}class Ut extends A{constructor(t,e,a){var i,s,n,r,l,o,d;super(t,e,a),this.id=null!==(s=null===(i=a[2])||void 0===i?void 0:i.toUpperCase())&&void 0!==s?s:"",this.name=null!==(n=a[3])&&void 0!==n?n:"",this.targetId=null!==(l=null===(r=a[4])||void 0===r?void 0:r.toUpperCase())&&void 0!==l?l:"",this.targetName=null!==(o=a[5])&&void 0!==o?o:"",this.tetherId=null!==(d=a[8])&&void 0!==d?d:""}}class Dt extends Ut{}class zt extends A{constructor(t,e,a){var i,s;super(t,e,a),this.valueHex=null!==(i=a[2])&&void 0!==i?i:"",this.valueDec=parseInt(this.valueHex,16),this.bars=null!==(s=a[3])&&void 0!==s?s:"",this.convertedLine=this.prefix()+"Limit Break: "+this.valueHex}}class Bt extends zt{}class Ot extends A{constructor(t,e,a){var i,s,n,r,l,o,d,u,p,m,c,h,g,f;super(t,e,a),this.id=null!==(s=null===(i=a[2])||void 0===i?void 0:i.toUpperCase())&&void 0!==s?s:"",this.name=null!==(n=a[3])&&void 0!==n?n:"",this.sequenceId=null!==(r=a[4])&&void 0!==r?r:"",this.currentHp=null!==(l=a[5])&&void 0!==l?l:"",this.maxHp=null!==(o=a[6])&&void 0!==o?o:"",this.currentMp=null!==(d=a[7])&&void 0!==d?d:"",this.maxMp=null!==(u=a[8])&&void 0!==u?u:"",this.currentTp=null!==(p=a[9])&&void 0!==p?p:"",this.maxTp=null!==(m=a[10])&&void 0!==m?m:"",this.x=null!==(c=a[11])&&void 0!==c?c:"",this.y=null!==(h=a[12])&&void 0!==h?h:"",this.z=null!==(g=a[13])&&void 0!==g?g:"",this.heading=null!==(f=a[14])&&void 0!==f?f:""}}class Zt extends Ot{}class Gt extends A{constructor(t,e,a){var i,s,n,r,l,o,d,u,p,m,c,h,g,f;super(t,e,a),this.id=null!==(s=null===(i=a[2])||void 0===i?void 0:i.toUpperCase())&&void 0!==s?s:"",this.name=null!==(n=a[3])&&void 0!==n?n:"",this.jobLevelData=null!==(r=a[4])&&void 0!==r?r:"",this.currentHp=null!==(l=a[5])&&void 0!==l?l:"",this.maxHp=null!==(o=a[6])&&void 0!==o?o:"",this.currentMp=null!==(d=a[7])&&void 0!==d?d:"",this.maxMp=null!==(u=a[8])&&void 0!==u?u:"",this.currentTp=null!==(p=a[9])&&void 0!==p?p:"",this.maxTp=null!==(m=a[10])&&void 0!==m?m:"",this.x=null!==(c=a[11])&&void 0!==c?c:"",this.y=null!==(h=a[12])&&void 0!==h?h:"",this.z=null!==(g=a[13])&&void 0!==g?g:"",this.heading=null!==(f=a[14])&&void 0!==f?f:"";const y=F.zeroPad(this.jobLevelData,8);this.jobIdHex=y.substr(6,2).toUpperCase(),this.jobIdDec=parseInt(this.jobIdHex,16),this.jobName=it(this.jobIdDec),this.level=parseInt(y.substr(4,2),16)}}class $t extends Gt{}class Xt extends A{constructor(t,e,a){var i,s,n,r,l,o,d,u,p,m,c,h,g;super(t,e,a),this.id=null!==(s=null===(i=a[2])||void 0===i?void 0:i.toUpperCase())&&void 0!==s?s:"",this.name=null!==(n=a[3])&&void 0!==n?n:"",this.currentHp=parseInt(null!==(r=a[4])&&void 0!==r?r:""),this.maxHp=parseInt(null!==(l=a[5])&&void 0!==l?l:""),this.currentMp=parseInt(null!==(o=a[6])&&void 0!==o?o:""),this.maxMp=parseInt(null!==(d=a[7])&&void 0!==d?d:""),this.currentTp=parseInt(null!==(u=a[8])&&void 0!==u?u:""),this.maxTp=parseInt(null!==(p=a[9])&&void 0!==p?p:""),this.x=parseFloat(null!==(m=a[10])&&void 0!==m?m:""),this.y=parseFloat(null!==(c=a[11])&&void 0!==c?c:""),this.z=parseFloat(null!==(h=a[12])&&void 0!==h?h:""),this.heading=parseFloat(null!==(g=a[13])&&void 0!==g?g:"")}}class Yt extends Xt{}const _t=t=>!!t;class Wt extends R{convertFile(t){const e=new Z;return this.convertLines(t.split(Wt.lineSplitRegex).filter((t=>""!==t)),e)}convertLines(t,e){let a=t.map((t=>class{static parse(t,e){let a;const i=e.split("|"),s=i[0];if(s&&"252"!==s){switch("LineEvent"+s){case"LineEvent00":a=new $(t,e,i);break;case"LineEvent01":a=new D(t,e,i);break;case"LineEvent02":a=new Y(t,e,i);break;case"LineEvent03":a=new nt(t,e,i);break;case"LineEvent04":a=new lt(t,e,i);break;case"LineEvent12":a=new dt(t,e,i);break;case"LineEvent20":a=new pt(t,e,i);break;case"LineEvent21":a=new ct(t,e,i);break;case"LineEvent22":a=new gt(t,e,i);break;case"LineEvent23":a=new yt(t,e,i);break;case"LineEvent24":a=new bt(t,e,i);break;case"LineEvent25":a=new xt(t,e,i);break;case"LineEvent26":a=new St(t,e,i);break;case"LineEvent27":a=new Mt(t,e,i);break;case"LineEvent28":a=new wt(t,e,i);break;case"LineEvent29":a=new Ft(t,e,i);break;case"LineEvent30":a=new Lt(t,e,i);break;case"LineEvent31":a=new jt(t,e,i);break;case"LineEvent34":a=new At(t,e,i);break;case"LineEvent35":a=new Dt(t,e,i);break;case"LineEvent36":a=new Bt(t,e,i);break;case"LineEvent37":a=new Zt(t,e,i);break;case"LineEvent38":a=new $t(t,e,i);break;case"LineEvent39":a=new Yt(t,e,i);break;default:a=new A(t,e,i)}if(!(a&&a.timestamp<946684800||a&&a.invalid))return a}}}.parse(e,t))).filter(_t);return a=a.map(((t,e)=>(t.index=e,t))),a.sort(((t,e)=>`${t.timestamp}_${t.index}`.localeCompare(`${e.timestamp}_${e.index}`)))}}Wt.lineSplitRegex=/\r?\n/gm,onmessage=async t=>{const e=new Wt,a=new z,i=new Z;a.on("fight",(async(t,e,a,i)=>{const s=new O(t,e,a,i);s.shouldPersistFight()&&postMessage({type:"encounter",encounter:s,name:s.combatantTracker.getMainCombatantName()})}));const s=new TextDecoder("UTF-8");let n=new Uint8Array(t.data),r=0,l=[],o=0;for(let t=r;r<n.length&&-1!==r;t=r){r=n.indexOf(10,r+1);const d=s.decode(n.slice(t,r)).trim();d.length&&(++o,l.push(d)),l.length>=1e3&&(l=e.convertLines(l,i),a.parseLogs(l),postMessage({type:"progress",lines:o,bytes:r,totalBytes:n.length}),l=[])}l.length>0&&(l=e.convertLines(l,i),a.parseLogs(l),l=[]),postMessage({type:"progress",lines:o,bytes:n.length,totalBytes:n.length}),n=null,a.endFight(),postMessage({type:"done"})}})();